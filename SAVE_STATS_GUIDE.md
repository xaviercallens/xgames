# 📊 Save Game Statistics Feature

## Overview

Press **'S'** during gameplay to save comprehensive game statistics to a text file. This feature works with or without video recording!

## Features

✅ **Comprehensive Stats**: AI info, win rates, performance metrics  
✅ **Works Standalone**: Save stats without recording  
✅ **Auto-Included with Recording**: Stats saved when you stop recording  
✅ **Human-Readable Format**: Easy-to-read text files  
✅ **Performance Analysis**: Detailed breakdown of your gameplay  

---

## Quick Start

### Option 1: Save Stats with Recording

```bash
# 1. Start game
./play_bomberman.py

# 2. Press 'R' to start recording
# 3. Play your game
# 4. Press 'S' to stop recording AND save stats
```

**Output:**
```
recordings/
├── game_1_20251014_080000.webm
├── game_1_20251014_080000.mp4
├── game_1_20251014_080000_preview.gif
├── game_1_20251014_080000_metadata.json
└── game_1_20251014_080000_stats.txt  ← Game statistics!
```

### Option 2: Save Stats Without Recording

```bash
# 1. Start game
./play_bomberman.py

# 2. Play your game
# 3. Press 'S' to save stats only
```

**Output:**
```
game_stats/
└── game_stats_20251014_080000.txt
```

---

## Statistics Included

### 📹 Recording Information
- Recording name
- Date and time
- Duration
- FPS and resolution
- Frames captured

### 🤖 AI Opponent Information
- AI Type (Heuristic, PPO, Hybrid)
- Model path
- Skill level

### 🏆 Game Result
- Winner
- Game duration
- Total turns

### 📊 Performance Statistics
- Total games played
- Human wins / AI wins / Draws
- Win rates for both players
- Current and best win streaks

### 🎮 Current Game Statistics

**Player (Human):**
- Moves made
- Bombs placed
- Walls broken
- Powerups collected
- Near-death experiences
- Strategy (Aggressive/Defensive/Balanced)
- Average risk level
- Performance score (0-100)

**AI Opponent:**
- Same metrics as human player

### 💡 Recommendations
- Personalized gameplay tips
- Strategy suggestions
- Performance improvements

---

## Example Output

```
================================================================================
PROUTMAN GAMEPLAY STATISTICS
================================================================================

Generated: 2025-10-14 08:00:00

🤖 AI OPPONENT INFORMATION
--------------------------------------------------------------------------------
AI Type:         Improved Heuristic
Model Path:      N/A
Skill Level:     Intermediate

🏆 GAME RESULT
--------------------------------------------------------------------------------
Winner:          Player
Game Duration:   45.23 seconds
Total Turns:     0

📊 PERFORMANCE STATISTICS
--------------------------------------------------------------------------------
Total Games:     15
Human Wins:      8
AI Wins:         7
Draws:           0
Human Win Rate:  53.3%
AI Win Rate:     46.7%

🔥 WIN STREAKS
--------------------------------------------------------------------------------
Human Current:   2
Human Best:      3
AI Current:      0
AI Best:         4

🎮 CURRENT GAME STATISTICS
--------------------------------------------------------------------------------

Player (Human):
  Moves:         45
  Bombs Placed:  8
  Walls Broken:  12
  Powerups:      3
  Near Deaths:   2
  Strategy:      Balanced
  Avg Risk:      35.2
  Performance:   72.5/100

AI Opponent:
  Moves:         42
  Bombs Placed:  6
  Walls Broken:  10
  Powerups:      2
  Near Deaths:   3
  Strategy:      Aggressive
  Avg Risk:      45.8
  Performance:   65.3/100

💡 RECOMMENDATIONS
--------------------------------------------------------------------------------
1. ✅ Good gameplay! Keep it up!

================================================================================
Generated by Proutman Video Recorder
Video files: game_1_20251014_080000.webm, .mp4, .gif
================================================================================
```

---

## Use Cases

### 1. Performance Tracking
Track your improvement over time by comparing stats from different sessions.

### 2. AI Comparison
Compare performance against different AI types and skill levels.

### 3. Strategy Analysis
Analyze your strategy (Aggressive vs Defensive) and its effectiveness.

### 4. Sharing Results
Share your stats files with friends or on social media.

### 5. Training Documentation
Document your training progress when learning the game.

---

## File Locations

### With Recording
```
recordings/
└── [recording_name]_stats.txt
```

### Without Recording
```
game_stats/
└── game_stats_[timestamp].txt
```

---

## Controls Summary

| Key | Action | When |
|-----|--------|------|
| **R** | Start/Stop recording | During gameplay |
| **S** | Save recording with stats | While recording |
| **S** | Save stats only | Not recording |

---

## Tips

### Best Practices

1. **Save After Good Games**: Press 'S' after wins to document success
2. **Track Progress**: Save stats regularly to see improvement
3. **Compare Strategies**: Try different playstyles and compare stats
4. **AI Benchmarking**: Test against different AI levels

### Performance Metrics Explained

**Performance Score (0-100):**
- **0-30**: Needs improvement
- **30-50**: Learning
- **50-70**: Intermediate
- **70-85**: Advanced
- **85-100**: Expert

**Strategy Types:**
- **Aggressive**: >60% moves toward enemy
- **Defensive**: <40% moves toward enemy
- **Balanced**: 40-60% moves toward enemy

**Risk Level (0-100):**
- **0-20**: Very safe play
- **20-40**: Moderate risk
- **40-60**: High risk
- **60-80**: Very high risk
- **80-100**: Extreme danger

---

## Advanced Usage

### Batch Analysis

Collect multiple stat files and analyze trends:

```bash
# View all stats
ls -la game_stats/

# Compare win rates
grep "Human Win Rate" game_stats/*.txt

# Find best performance
grep "Performance:" game_stats/*.txt | sort
```

### Custom Analysis

Parse the text files with scripts:

```python
import re

def parse_stats(filename):
    with open(filename) as f:
        content = f.read()
        
    # Extract win rate
    match = re.search(r'Human Win Rate:\s+([\d.]+)%', content)
    if match:
        win_rate = float(match.group(1))
        print(f"Win Rate: {win_rate}%")
```

---

## Integration with Video Recording

When you press 'S' while recording:

1. **Recording stops** automatically
2. **Video files** are encoded (WebM, MP4, GIF)
3. **Stats file** is generated with game data
4. **Metadata JSON** includes statistics
5. **HTML embed** page is created

All files are saved together in the `recordings/` directory!

---

## Troubleshooting

### Stats File Not Created

**Problem**: Pressed 'S' but no file appeared.

**Solutions**:
- Check `game_stats/` directory exists
- Verify write permissions
- Look for error messages in console

### Incomplete Statistics

**Problem**: Some stats show 0 or "Unknown".

**Cause**: Game just started or stats not yet tracked.

**Solution**: Play for a bit before saving stats.

### Can't Find Stats File

**Check these locations**:
```bash
# With recording
ls recordings/*_stats.txt

# Without recording
ls game_stats/*.txt
```

---

## Future Enhancements

Planned features:

- [ ] CSV export for spreadsheet analysis
- [ ] JSON export for programmatic access
- [ ] Graphs and charts generation
- [ ] Comparison mode (multiple games)
- [ ] Leaderboard integration
- [ ] Cloud sync (optional)

---

## Examples

### Example 1: Track Improvement

```bash
# Day 1
./play_bomberman.py
# Play, press S
# Win rate: 30%

# Day 7
./play_bomberman.py
# Play, press S
# Win rate: 55%

# Compare files to see improvement!
```

### Example 2: AI Benchmarking

```bash
# Test against Heuristic AI
# Press S after 10 games
# Note win rate

# Test against PPO AI
# Press S after 10 games
# Compare results
```

### Example 3: Strategy Testing

```bash
# Try aggressive strategy
# Press S
# Note performance score

# Try defensive strategy
# Press S
# Compare which works better
```

---

## FAQ

**Q: Does saving stats affect game performance?**  
A: No, it's a quick file write operation.

**Q: Can I save stats multiple times per game?**  
A: Yes! Press 'S' anytime to save current stats.

**Q: Are stats cumulative?**  
A: Yes, total games/wins are tracked across sessions.

**Q: Can I edit the stats files?**  
A: Yes, they're plain text files. Edit as needed.

**Q: Do stats reset when I restart?**  
A: No, historical data is preserved in `game_history.json`.

**Q: Can I share stats files?**  
A: Absolutely! They're designed to be human-readable.

---

## Related Features

- **Video Recording**: See [VIDEO_RECORDING_GUIDE.md](VIDEO_RECORDING_GUIDE.md)
- **Game Statistics**: See `bomber_game/game_statistics.py`
- **Performance Tracking**: See `bomber_game/stats_panel.py`

---

**Created**: 2025-10-14  
**Feature**: Save Game Statistics  
**Key**: Press 'S'  
**Status**: ✅ Ready to Use
